{
    "code": "// verification-helper: PROBLEM https://judge.yosupo.jp/problem/queue_operate_all_composite\n#include \"data_structure/sliding_window_aggregation/deque.hpp\"\n#include \"utility/modint.hpp\"\n#include \"utility/printer.hpp\"\n#include \"utility/scanner.hpp\"\nint main()\n{\n    using mint = modint_998244353;\n    using Func = std::pair<mint, mint>;\n    const auto Q = in.val<int>();\n    struct SemiGroup\n    {\n        using T = Func;\n        // f2 \\circ f1 \u306a\u306e\u3067\u6ce8\u610f\n        T operator()(const T& f1, const T& f2) const\n        {\n            return T{f2.first * f1.first, f2.first * f1.second + f2.second};\n        }\n    };\n\n    auto deque = SwagDeque<SemiGroup>{};\n    LOOP (Q) {\n        const auto t = in.val<int>();\n        if (t == 0) {\n            const auto [a, b] = in.tup<mint, mint>();\n            deque.pushBack(Func{a, b});\n        } else if (t == 1) {\n            deque.popFront();\n        } else {\n            const auto x = in.val<mint>();\n            if (deque.empty()) {\n                out.ln(x.val());\n            } else {\n                const auto [a, b] = deque.foldAll();\n                out.ln((a * x + b).val());\n            }\n        }\n    }\n    return 0;\n}\n",
    "result": "AC"
}