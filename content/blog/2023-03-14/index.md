+++
title = '2023/03/14'
date = '2023/03/14'
publishDate = '2023/03/14'
archives = ['2023/03']
draft = true
math = true
+++

日中は仕事

今日は朝昼晩全部残り物のクラムチャウダーを食べた。特に朝に暖かいスープを食べると気分がいい。  
クラムチャウダーを食べきったので、明日は待望のスパイスカレーを作るか。

今日は昨日解きそびれた https://yukicoder.me/problems/no/2243 を解いた。  
昨日の立式（下記）でほぼ終わっていた。
$$
\begin{aligned}
&\sum_{j=0}^N \frac{(-1)^j}{j!} \sum_{d=0}^{N-j} (d!)^{M-1}\frac{(j+d)!}{\prod_{k=1}^M (d-n_k)!}\\\\
\text{where }\\\\
&n_k = \\# \lbrace i \mid A_i = k \rbrace
\end{aligned}
$$
式の左半分を $f(j)$ 、右半分のうち $(j+d)!$ 以外の部分を $g(d)$ とおくと、求める答えは $\sum_{i=0}^N (f \ast g)(i) \times i!$ になる。  
あとは $g(d)$ の各項を高速に求めればいいが、 $\prod_{k=1}^M (d-N_k)!$ が問題。  
これは値の等しい $n_k$ をまとめると、$\sum_{k}n_k = N$ より $\sqrt{N}$ 倍高速化が可能。  

さらに次の問題 https://yukicoder.me/problems/no/2244 も解いた。
- $A,B$ のどちらか一方が1を含まないなら、答えは1
- $A,B$ のどちらも2を含まないなら、答えは5
- $A,B$ のどちらも3を含まないなら、答えは11
- $A,B$ のどちらも4を含まないなら、答えは17

ここまで確かめて、含まれない最小の素数がカギだなと予想。  
答えが素数とは限らない（$A\lbrace 1,2,3,4\rbrace, B=\lbrace 1 \rbrace$ など）が、上界にはなる。
$A \cup B$ の MEX   （0は省く）を $K$ として、$\lbrack K^2,(K+1)^2 \rparen$ に含まれる素数が良い上界になりそう。

と思ったが、一般に $\lbrack K^2, (K+1)^2 \rparen$ に素数は含まれるのか？というのが疑問になる。$\lbrack N, 2N \rparen$ には一般に含まれるはずだがそれだと全然示せないなぁとなる。  
ただ脳内計算したり篩の気持ちになると素数が含まれる気がするので、実験する。
素数が含まれるどころか $K^2$ に十分近い位置に存在することが分かるので、愚直にチェックしてAC

解説を読むとまぁそうかという気持ちに。よく考えると素数定理から素数の密度は $\frac{1}{\log{N}}$ 程度だし、素数の間隔はまぁ小さいのかなという気になってくる。  
ググって [Wikipedia](https://ja.wikipedia.org/wiki/%E7%B4%A0%E6%95%B0%E3%81%AE%E9%96%93%E9%9A%94) を読んだがいまいち頭には入ってこなかった。
